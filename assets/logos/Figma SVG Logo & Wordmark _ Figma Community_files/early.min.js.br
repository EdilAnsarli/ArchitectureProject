
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="eb99594c-4b8a-5f88-a52f-be6711a254da")}catch(e){}}();
function B(n,t,e){let l=t?"/api/livegraph-next":"/api/livegraph",i,r;if(n)try{let f=new URL(n);r=f.protocol,i=f.host}catch{}return(i===void 0||r===void 0)&&(i=location.host,i==="admin.staging.figma.com"||i==="embed.staging.figma.com"?i="staging.figma.com":(i==="admin.figma.com"||i==="embed.figma.com")&&(i="www.figma.com"),r=location.protocol),`${r==="https:"?"wss":"ws"}://${i}${l}?${e}`}function F(n,t,e){return B(n,!!t,e??"")}var P=class extends WebSocket{constructor(e,s,c){super(e,s);this.onCloseCb=c;this.events=[];this._onopen_=null;this._onmessage_=null;this._onclose_=null;this._onerror_=null;super.onopen=this.onOpen,super.onmessage=this.onMessage,super.onclose=this.onClose,super.onerror=this.onError}onOpen(e){this.events.push({event:"onopen",ev:e}),this.flushIfInitialized()}onMessage(e){this.events.push({event:"onmessage",ev:e}),this.flushIfInitialized()}onClose(e){var s;(s=this.onCloseCb)==null||s.call(this),this.events.push({event:"onclose",ev:e}),this.flushIfInitialized()}onError(e){this.events.push({event:"onerror",ev:e}),this.flushIfInitialized()}flushIfInitialized(){if(!(!this._onmessage_||!this._onopen_||!this._onclose_||!this._onerror_))for(;this.events.length>0;){let{event:e,ev:s}=this.events.shift();switch(e){case"onopen":this._onopen_(s);break;case"onmessage":this._onmessage_(s);break;case"onclose":this._onclose_(s);break;case"onerror":this._onerror_(s);break}}}set onopen(e){this._onopen_=e,this.flushIfInitialized()}get onopen(){return this._onopen_}set onmessage(e){this._onmessage_=e,this.flushIfInitialized()}get onmessage(){return this._onmessage_}set onclose(e){this._onclose_=e,this.flushIfInitialized()}get onclose(){return this._onclose_}set onerror(e){this._onerror_=e,this.flushIfInitialized()}get onerror(){return this._onerror_}};var k=window.matchMedia("(prefers-color-scheme: dark)");function b(n){return n==="system"?k.matches?"dark":"light":n==="dark"?"dark":"light"}self.global=self;var H=112,V=(n,t,e,s,c,l)=>{if(n)window.userStateXHR={readyState:4,status:200,responseText:n};else if(window.Fig){if(s||!window.INITIAL_OPTIONS.user_data){window.startUserStateXHR=()=>{};return}window.startUserStateXHR=function(f){var g;let u=c;if(!u){u="/api/user/state";var a=[];window.INITIAL_OPTIONS.org_id&&a.push("org_id="+window.INITIAL_OPTIONS.org_id),window.INITIAL_OPTIONS.team_id&&a.push("team_id="+window.INITIAL_OPTIONS.team_id),e&&a.push("omit_core_data=1"),f&&a.push("file_key="+f),a.length!==0&&(u+="?"+a.join("&"))}window.userStateXHR=new XMLHttpRequest,window.userStateXHR.open("GET",u);let o=(g=window.INITIAL_OPTIONS.user_data)==null?void 0:g.id;o&&window.userStateXHR.setRequestHeader("X-Figma-User-ID",o),window.userStateXHR.send();var I=window.performance?window.performance.now():-1;window.userStateXHR.addEventListener("load",function(){window.userStateXHRDuration=window.performance?window.performance.now()-I:-1},!1),window.sessionStateXHR=new XMLHttpRequest,window.sessionStateXHR.open("GET",l||"/api/session/state"),o&&window.sessionStateXHR.setRequestHeader("X-Figma-User-ID",o),window.sessionStateXHR.send()};let i=location.pathname==="/preload-editor"||location.pathname==="/preload-android-proto"||location.pathname==="/file/new"||location.pathname==="/design/new"||location.pathname==="/board/new",r=window.INITIAL_OPTIONS.editing_file&&window.INITIAL_OPTIONS.editing_file.key;t?window.startUserStateXHR(r):i||window.startUserStateXHR()}};function $(n){return n==="dark"?"1E1E1E":"F5F5F5"}function X(){let n=null;try{n=window.localStorage}catch{}return n}function z(){var e;if(!((e=window.INITIAL_OPTIONS.feature_flags)!=null&&e.send_initial_bg_color))return"";let n=W(X()),t=b(n);return $(t)}var G="global-debug-theme-preference";function W(n){var t;if(n){let e=n==null?void 0:n.getItem(G);return(t=window.INITIAL_OPTIONS.feature_flags)!=null&&t.ee_system_theme_default&&!e?"system":e}return null}var D="chunked-file-load",K=5e3;function Y(){var e,s,c;if(!((s=(e=window.INITIAL_OPTIONS)==null?void 0:e.feature_flags)!=null&&s.manifest_commit_sha))return H;let n=(c=window.INITIAL_OPTIONS)==null?void 0:c.cluster_name;if(n!=="staging"&&n!=="local")return H;let t=window.location.search;if(t.includes("force-client-version")){let i=new URLSearchParams(t).get("force-client-version");if(i){let r=parseInt(i);if(!isNaN(r)&&r>0)return console.log(`!! Overriding client version to ${r}`),r}}return H}var j=(n,t)=>{var r,f,u;let e=(r=window.INITIAL_OPTIONS.user_data)==null?void 0:r.id,s=window.INITIAL_OPTIONS.tracking_session_id,c=window.INITIAL_OPTIONS.release_manifest_git_commit,l=window.__figmaDesktop,i=l!=null&&((u=(f=window.INITIAL_OPTIONS)==null?void 0:f.feature_flags)!=null&&u.desktop_mp_client_id)?l.clientID:null;window.mpGlobal={version:Y(),sock:null,msgs:[],perfMetrics:[],shouldConnectToMultiplayer:n,url({fileKey:a,role:o,oauthToken:I,nodeIds:g,initialBgColor:_,suppressDecodeErrors:S,connectionType:E,tagForLogging:T,forceViewOnly:N}){var M,y,C;if(!n)return"";let m=null;t&&a===t.fileKey&&t.targetFileVersion&&(m=t.targetFileVersion);let h="";(o==="editor"||o==="viewerWithCpp")&&g&&(h+=`&scenegraph-queries-initial-nodes=${g}`);let v=window.location.search,w=new URLSearchParams(v),d=w.get("recovery")==="true",p=w.get("merge-on-file-open")==="true";o==="editor"&&(t==null?void 0:t.forceIncrementalForEditors)===1&&!d&&!p?h+="&use-incremental-for-editors=1":((t==null?void 0:t.forceIncrementalForEditors)===0||d||p)&&(h+="&use-incremental-for-editors=0"),o==="editor"&&((M=window.INITIAL_OPTIONS.feature_flags)!=null&&M.incremental_loading_validation)&&(h+="&incremental-loading-validation=1");let O=1;try{let A=JSON.parse(sessionStorage.getItem("reload_times")||"[0]"),x=A[A.length-1];O=Date.now()-x<5e3?1:0}catch{}(o!=="editor"||!((y=window.INITIAL_OPTIONS.feature_flags)!=null&&y.send_initial_bg_color))&&(_="");let L=((C=window.INITIAL_OPTIONS.feature_flags)==null?void 0:C.chunked_file_load)&&E==="initial-load",R=window.INITIAL_OPTIONS.e2e_traffic,U=window.INITIAL_OPTIONS.e2e_test_name;return`${location.protocol.replace("http","ws")}//${location.host}/api/multiplayer/${a}?role=${o}&tracking_session_id=${s}&version=${this.version}&recentReload=${O}&file-load-streaming-compression`+h+(I?"&oauth_token="+I:"")+(e?`&user-id=${e}`:"")+(m?`&target-file-version=${m}`:"")+(c?`&client_release=${c}`:"")+(_?`&initial-bg-color=${_}`:"")+(S?"&suppress-decode-errors":"")+(L?`&${D}`:"")+(L?`&chunk-size=${K}`:"")+(T?`&tag-for-logging=${T}`:"")+(R?"&e2e_traffic=true":"")+(U?`&e2e_test_name=${U}`:"")+(N?"&force-view-only":"")+(i?`&clientID=${i}`:"")},DEBUG_THEME_PREFERENCE_KEY:G,DARK_THEME_MEDIA_QUERY:k,themePreferenceFromLocalStorage:W,getBackgroundColorForTheme:$,getVisibleTheme:b,REQUEST_CHUNKED_FILE_LOAD_PARAM:D,preconnect(a){if(n!==!1){if(this.sock){if(a===this.sock.url&&this.sock.readyState!==WebSocket.CLOSED)return;try{this.sock.close()}catch{}}this.sock=new WebSocket(a),this.sock.binaryType="arraybuffer",this.sock.onopen=o=>{this.perfMetrics.push({key:"mp-ws-onopen",ts:performance.now(),nBytes:void 0})},this.sock.onmessage=o=>{let I=new Uint8Array(o.data);this.msgs.push(I),this.perfMetrics.push({key:"mp-ws-onmessage",ts:performance.now(),nBytes:I.length*I.BYTES_PER_ELEMENT})},this.msgs=[],this.perfMetrics=[]}}},t&&mpGlobal.preconnect(mpGlobal.url(t))},Q=n=>{let t=()=>{let s=document.createElement("script");return s.type="text/javascript",s.async=!0,s.setAttribute("nonce",window.INITIAL_OPTIONS.csp_nonce),s.crossOrigin="anonymous",s},e=new Promise((s,c)=>{let l=t();l.onload=s,l.src=n,document.head.appendChild(l)});return e.catch(s=>console.error(`Fetching ${n} failed: ${s}`)),e};(()=>{var a,o,I,g,_,S,E,T,N,m,h,v;let{file_minimal_user_state:n,mock_user_state_for_tests_json:t,multiplayer_preconnect_options:e,omit_core_data:s,omit_user_state:c,preload_fullscreen_urls:l,should_connect_to_multiplayer:i,api_user_state_path:r,api_session_state_path:f}=window.EARLY_ARGS||{};if(window.INITIAL_OPTIONS||(window.INITIAL_OPTIONS={}),V(t,!!n,!!s,!!c,r,f),!/iPhone|iPad|iPod/.test(navigator.userAgent)){let w=(o=(a=window.INITIAL_OPTIONS)==null?void 0:a.feature_flags)==null?void 0:o.livegraph_connect_next,d=new URLSearchParams((I=window.INITIAL_OPTIONS)==null?void 0:I.page_load_token);d.append("userId",((_=(g=window.INITIAL_OPTIONS)==null?void 0:g.user_data)==null?void 0:_.id)||""),d.append("anonUserId",((S=window.INITIAL_OPTIONS)==null?void 0:S.anonymous_user_id)||"");let p=!!window.__figmaDesktop;d.append("clientType",p?"desktop":"web"),d.append("clientUrl",document.URL),d.append("commitHash",((E=window.INITIAL_OPTIONS)==null?void 0:E.release_manifest_git_commit)||"missing");let O=((T=window.INITIAL_OPTIONS)==null?void 0:T.livegraph_preload_views)||{};d.append("preload",JSON.stringify(O));let L=(N=window.INITIAL_OPTIONS)==null?void 0:N.figma_url,R=F(L,w,d.toString());window.LGEarlyWS=new P(R,void 0,()=>{window.LGEarlyWS=void 0})}if(e&&(e.initialBgColor=z(),e.connectionType="initial-load",e.forceViewOnly=!1,(((m=window.INITIAL_OPTIONS)==null?void 0:m.cluster_name)==="staging"||((h=window.INITIAL_OPTIONS)==null?void 0:h.cluster_name)==="local")&&((v=X())!=null&&v.getItem("force-vscode"))?e.forceViewOnly=!0:e.forceViewOnly=(window==null?void 0:window.location.ancestorOrigins)&&[...window.location.ancestorOrigins].some(w=>w.startsWith("vscode-webview://"))),j(i!==!1,e),!l&&!/FigmaMobile-Android/.test(navigator.userAgent)&&((e==null?void 0:e.role)==="editor"||(e==null?void 0:e.role)==="viewerWithCpp"||(e==null?void 0:e.role)==="prototype")){let w=(e==null?void 0:e.role)==="prototype"?Fig.prototypeLibURLs:Fig.fullscreenURLs,d=fetch(w["compiled_wasm.wasm"]);d.catch(O=>console.error(`Fetching compiled_wasm.wasm failed: ${O}`));let p=Q(w["compiled_wasm.js"]);window.FULLSCREEN_PRELOADS={wasm:d,js:p}}})();
/*! For license information please see early.min.js.LEGAL.txt */

//# debugId=eb99594c-4b8a-5f88-a52f-be6711a254da

//# sourceMappingURL=https://admin.figma.com/admin/esbuild-artifacts/6fd970ae2d505ace3bac17a95ed515f766546752/js/early.min.js.map